(function() {'use strict';window.__deferCssDebug = {started: Date.now(),logs: []};function debugLog(msg) {const timestamp = Date.now() - window.__deferCssDebug.started;window.__deferCssDebug.logs.push(`[${timestamp}ms] ${msg}`);console.log('[defer-css]', msg);}debugLog('Script started');const assetManifest = window.__assetManifest__ || {};const manifestSize = Object.keys(assetManifest).length;debugLog('Asset manifest loaded: ' + manifestSize + ' entries');if (manifestSize === 0) {debugLog('WARNING: Manifest is empty! Possible browser cache issue or manifest not injected.');}const indexDeferredCss = assetManifest['styles-index-deferred.css'];const commonDeferredCss = assetManifest['css/components-deferred.css'];debugLog('Index deferred CSS lookup: "styles-index-deferred.css" -> ' + (indexDeferredCss || 'NOT FOUND'));debugLog('Common deferred CSS lookup: "css/components-deferred.css" -> ' + (commonDeferredCss || 'NOT FOUND'));const deferredStyles = {'index': indexDeferredCss ? '/' + indexDeferredCss : null,'common': commonDeferredCss ? '/' + commonDeferredCss : null};if (!indexDeferredCss) {debugLog('ERROR: Index deferred CSS not found in manifest - styles may not load!');}if (!commonDeferredCss) {debugLog('ERROR: Common deferred CSS not found in manifest - styles may not load!');}debugLog('Deferred styles resolved: ' + JSON.stringify(deferredStyles));function loadDeferredCSS(href) {debugLog('Loading deferred CSS: ' + href);const link = document.createElement('link');link.rel = 'stylesheet';link.href = href;link.media = 'print';link.onload = function() {debugLog('CSS loaded (onload): ' + href + ', setting media to all');this.media = 'all';};link.onerror = function() {debugLog('ERROR loading CSS: ' + href);};setTimeout(function() {debugLog('Timeout fired for ' + href + ', setting media to all');link.media = 'all';}, 3000);document.head.appendChild(link);debugLog('Link element appended to head: ' + href);}function loadPageDeferredCSS() {debugLog('loadPageDeferredCSS called');debugLog('document.readyState: ' + document.readyState);debugLog('document.head: ' + (document.head ? 'exists' : 'MISSING'));if (deferredStyles['common']) {debugLog('Loading common deferred styles');loadDeferredCSS(deferredStyles['common']);} else {debugLog('ERROR: No common deferred styles to load - manifest may be empty or CSS not found in manifest');}const isIndex = document.body.classList.contains('home') ||window.location.pathname === '/' ||window.location.pathname === '/index.html';debugLog('Is index page: ' + isIndex + ' (pathname: ' + window.location.pathname + ')');if (isIndex && deferredStyles['index']) {debugLog('Loading index deferred styles');loadDeferredCSS(deferredStyles['index']);} else if (isIndex && !deferredStyles['index']) {debugLog('ERROR: This is index page but no index deferred styles available - manifest issue');} else {debugLog('Not loading index styles');}}if (document.readyState === 'loading') {debugLog('Document loading, waiting for DOMContentLoaded');document.addEventListener('DOMContentLoaded', function() {debugLog('DOMContentLoaded fired');requestAnimationFrame(function() {debugLog('requestAnimationFrame fired');setTimeout(loadPageDeferredCSS, 100);});});} else {debugLog('Document already loaded, calling immediately');requestAnimationFrame(function() {debugLog('requestAnimationFrame fired');setTimeout(loadPageDeferredCSS, 100);});}})();