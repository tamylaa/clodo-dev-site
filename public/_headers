# Cloudflare Pages headers configuration for Clodo Framework
# Enterprise-grade security and performance optimization

# Admin/Monitoring Pages - RESTRICTED ACCESS
/performance-dashboard.html
  X-Robots-Tag: noindex, nofollow
  X-Frame-Options: DENY
  X-Content-Type-Options: nosniff
  Referrer-Policy: no-referrer
  Cache-Control: private, no-cache, no-store, must-revalidate

/analytics.html
  X-Robots-Tag: noindex, nofollow
  X-Frame-Options: DENY
  X-Content-Type-Options: nosniff
  Cache-Control: private, no-cache, no-store, must-revalidate

# AI Agent Resources - ALLOW INDEXING (Critical for AI Discovery)
/structured-data.html
  X-Robots-Tag: index, follow, max-snippet:-1, max-image-preview:large
  Cache-Control: public, max-age=86400
  
/sitemap.xml
  X-Robots-Tag: index, follow
  Cache-Control: public, max-age=3600

# Lighthouse audit bypass - allow bot for performance auditing
# This prevents rate-limiting from blocking legitimate performance metrics
/*.html
  # cf-bot-management-score: 100

# Default for all other pages
/*
  # Security Headers
  X-Frame-Options: DENY
  X-Content-Type-Options: nosniff
  X-XSS-Protection: 1; mode=block
  Referrer-Policy: strict-origin-when-cross-origin
  Permissions-Policy: camera=(), microphone=(), geolocation=()

  # Content Security Policy (CSP)
  # Note: We allow cloudflareinsights.com for beacon loading but prevent auto-injected versions
  # Note: We allow frame-src for Brevo chat widget integration
  Content-Security-Policy: default-src 'self'; script-src 'self' 'nonce-N0Nc3Cl0d0' https://static.cloudflareinsights.com https://www.googletagmanager.com https://www.google-analytics.com; script-src-elem 'self' 'nonce-N0Nc3Cl0d0' https://static.cloudflareinsights.com https://www.googletagmanager.com https://www.google-analytics.com https://conversations-widget.brevo.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://fonts.gstatic.com; font-src 'self' https://fonts.gstatic.com; img-src 'self' data: https: blob:; frame-src https://conversations-widget.brevo.com; connect-src 'self' https://api.github.com https://api.brevo.com https://www.google-analytics.com https://www.googletagmanager.com https://static.cloudflareinsights.com https://conversations-widget.brevo.com; object-src 'none'; base-uri 'self'; form-action 'self' https://api.brevo.com;

  # HTTPS Enforcement
  Strict-Transport-Security: max-age=31536000; includeSubDomains; preload

  # Core Web Vitals Optimization - Force fresh deployment
  X-DNS-Prefetch-Control: on

# Static Assets - Aggressive Caching
/*.css
  Cache-Control: public, max-age=31536000, immutable
  # Note: Cloudflare Auto Minify + Compression enabled

/*.js
  Cache-Control: public, max-age=31536000, immutable
  # Note: Cloudflare Auto Minify + Compression enabled

/*.woff2
  Cache-Control: public, max-age=31536000, immutable

/*.png
  Cache-Control: public, max-age=86400

/*.jpg
  Cache-Control: public, max-age=86400

/*.svg
  Cache-Control: public, max-age=86400

/*.webp
  Cache-Control: public, max-age=86400

# HTML Pages - Short Cache for Fresh Content
/*.html
  Cache-Control: public, max-age=3600, stale-while-revalidate=86400
  Vary: Accept-Encoding
  # Note: Cloudflare automatically gzips content - enable in dashboard

# Admin pages override (more specific rules above take precedence)

/robots.txt
  Cache-Control: public, max-age=3600

# API Routes - No Cache
/api/*
  Cache-Control: no-cache, no-store, must-revalidate
  Pragma: no-cache
  Expires: 0

# Security for Sensitive Files
/.env*
  X-Robots-Tag: noindex, nofollow

# JavaScript Modules
/js/github-integration.js
  Content-Type: application/javascript
  Cache-Control: public, max-age=31536000, immutable

/js/scroll-animations.js
  Content-Type: application/javascript
  Cache-Control: public, max-age=31536000, immutable

/js/component-nav.js
  Content-Type: application/javascript
  Cache-Control: public, max-age=31536000, immutable

# Service Worker (if implemented)
/sw.js
  Cache-Control: public, max-age=0, must-revalidate
  Service-Worker-Allowed: /